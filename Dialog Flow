
const functions = require('firebase-functions');
const {WebhookClient} = require('dialogflow-fulfillment');
const {Card, Suggestion} = require('dialogflow-fulfillment');
 
process.env.DEBUG = 'dialogflow:debug'; // enables lib debugging statements
 
exports.dialogflowFirebaseFulfillment = functions.https.onRequest((request, response) => {
  const agent = new WebhookClient({ request, response });
  
  function adicao(agent) {
    var soma = agent.parameters.number1 + agent.parameters.number2;
    
    agent.add('Resposta de seus calculos Ã©:' + soma);
    agent.add('TEXTO OPCIONAL');
}
  
  
  
  function oi (agent) {
    var interacao = "";
    var currentUtcTime = new Date();
    const d = new Date (currentUtcTime.toLocaleString('BR', { timeZone: 'America/Bahia' }));
    const hora = d.getHours();
    if (hora >= 1  && hora <= 12) {
      interacao = "ðŸŒž *Bom Dia*";
    } else if (hora >= 13 && hora <= 18) { 
      interacao = "ðŸŒ… *Boa Tarde*"; 
    } else {
      interacao = "ðŸŒš *Boa Noite*"; 
    }
   agent.add(`${interacao}, *%name%* eu me chamo *MARIA* sou assistente virtual do prÃ© candidato a prefeito *Padre GenÃ¡rio*.

Digite uma das opÃ§Ã£o ou se preferir digite de forma natural o que vocÃª quiser saber, pois eu estou em desenvolvimento e suas palavras serÃ¡ muito Ãºtil para mim.

*1* - ðŸ“² _Redes Sociais_ 
*2* - ðŸ“‘ _Propostas_ 
*3* - ðŸ“ _Biografia_ 
*4* - ðŸ“‹ _Programa de Governo Participativo_ 

*OUTROS ASSUNTOS*

*5* - ðŸ¦  _Corona VÃ­rus_
*6* - ðŸ™ï¸ _Sobre Gongogi_
*7* - ðŸ“ž _Telefones Importantes_
*8* - ðŸ“¤ _Sair_
`);
  }

  let intentMap = new Map();
  intentMap.set('Menu',oi);
  intentMap.set('adicao', adicao);
  agent.handleRequest(intentMap);
});
